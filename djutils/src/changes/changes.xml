<document xmlns="http://maven.apache.org/changes/1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/changes/1.0.0 http://maven.apache.org/xsd/changes-1.0.0.xsd">
  <body>

   <release version="1.04.07" date="2020-XX-XX" description="...">
   </release>
   
   <release version="1.04.06" date="2020-02-04" description="CliUtil for subclasses">
      <action dev="averbraeck" type="fix">
        CliUtil in djutils-ext had problems with changing the default option values for subclasses, where the 
        options were defined in a superclass. The key under which the overrides are stored in CliUtil have been
        changed to the actual class where the option was defined, both in storing and in retrieving the 
        override. Tests in the TestCLI unit tests check the new behavior.  
      </action> 
      <action dev="pknoppers" type="add">
        Added the Profile class to DJUTILS (moved it out of the ots-core project). Contains profiler code for methods or
        parts of methods.
      </action>
   </release>

   <release version="1.04.05" date="2020-01-24" description="Comparator immutableTreeset; new units for serialization">
      <action dev="pknoppers" type="add">
        Added the three new DJUNITS units  AngularAcceleration, AngularVelocity and Momentum to djutils-serialization.
      </action>
      <action dev="pknoppers" type="fix">
        The subSet, headSet and tailSet methods of ImmutableTreeSet would use the default comparator of the data type instead of
        inheriting the comparator of the underlying set. This bug was discovered while writing thorough unit tests.
        The documentation of (non-immutable) TreeSet is not clear about whether the subSet and friends should inherit the 
        comparator, but the implementations in the java Collections framework do inherit the comparator.
      </action>
    </release>
    
    <release version="1.04.04" date="2020-01-19" description="EventProducer uses Serializable sourceId">
      <action dev="averbraeck" type="update">
        In contrast with earlier implementations of the Event package, a sourceId is sent over the  network 
        rather than a pointer to the source itself. This has several advantages:
<![CDATA[
        <ol><li>The object extending the EventProducer does not have to be Serializable itself</li>
        <li>There is no risk that the entire EventProducer object gets serialized (including subclasses) 
        and is sent over the network</li>
        <li>The receiver of an event does not get a pointer to the sending object</li>
        <li>The receiver of an event is still able to identify the sending object</li></ol>
]]>
      </action>
    </release>
    
    <release version="1.04.03" date="2020-01-17" description="RMIUtils, RMIObject and RemoteEvent updates">
      <action dev="pknoppers" type="add">
        New version of generated code in TestCLIUnitConverters.java.
        New units in CliUnitConverters.
     </action>
      <action dev="averbraeck" type="add">
        The classes RMIUtils and RMIObject have been added to make it easier to work with remote objects. 
      </action>
      <action dev="averbraeck" type="update">
        RemoteEventProducer and RemoteEventListener extend RMIObject to select the host and port of the
        RMI registry. Therewith the remote event handling has become a lot more flexible.  
      </action>
      <action dev="averbraeck" type="update">
        EventProducer is not an abstract class anymore, as it does not contain any unimplemented methods and 
        because it is used as an embedded class in the RemoteEventProducer.  
      </action>
      <action dev="averbraeck" type="update">
        Demanded that the fields of the Event and TimedEvent are serializable, so they can be sent over
        the network or stored on disk by serialization. 
      </action>
    </release>  
    
    <release version="1.04.02" date="2020-01-05" description="EventProducer cleanup; Logger updates">
      <action dev="pknoppers" type="fix">
        Removed various redundant synchronized blocks from EventProducer.java (method was already synchronized).
      </action>
      <action dev="pknoppers" type="update">
        More complete nullPointer checks in EventProducer.java; Javadoc cleanup in EventProducer.java
      </action>
      <action dev="pknoppers" type="update">
        Removed the ConditionalLogger from the CategoryLogger and transfered the when(...) functions to
        both the static Logger and the DelegateLogger class.  
      </action>
      <action dev="pknoppers" type="fix">
        DelegateLogger did not consider the LogLevel correctly in deciding whether a message needed to be logged.
        This has been repaired. Every logging method now first checks whether the indicated log level is 
        included in the log levels that need to be shown. 
      </action>
      <action dev="pknoppers" type="update">
        CategoryLogger now has methods for adding and removing Writers, and listing which writers are available. 
      </action>
      <action dev="pknoppers" type="update">
        Expanded unit tests for CategoryLogger and EventProducer. 
      </action>
      <action dev="averbraeck" type="fix">
        The explicit setting of log level and message formatter on individual writers in the CategoryLogger now works
        as intended. The setAllLogMessageFormat and setAllLogLevel methods in the CategoryWriter reset the values
        for each individual Writer, as well as the global standard for next writers to be registered.
      </action>
      <action dev="averbraeck" type="fix">
        ClassUtil had a method called changeAnnotationValue to change the value of an annotation field value. This
        method made changes to an internal data structure that is not intended to be altered. From Java-13 onwards
        a warning appears in the console for manipulating this data structure. Therefore the method has been removed.
      </action>
      <action dev="averbraeck" type="fix">
        The CliUtil class in djutils-ext used the changeAnnotationValue method from ClassUtil. Instead of changing 
        the internal data structure of the annotations, an override map is now used to store the changes. This also
        ensures that the code structure is reentrant: no structural changes have been made to the appearance of the
        loaded code (which the changeAnnotationValue method did in a sense).
      </action>
      <action dev="averbraeck" type="add">
        Methods to read the (overridden or original) program version, program name and program description 
        in @Command have been added to CliUtil. 
      </action>
    </release>

    <release version="1.04.01" date="2019-12-31" description="EventProducer serializability">
      <action dev="averbraeck" type="fix">
        The EventProducer had a non-transient semaphore object, rendering it non-serializable. The
        lock has been replaced by a lock on the listeners object instead. The lock has been applied
        more consistently in the code to avoid ConcurrentModificationExceptions.
      </action>
      <action dev="averbraeck" type="update">
        All Dumper classes in DecoderDumper now use UTF-8 to dump the data, to ensure reproducibility of the
        code across platforms.
      </action>
    </release>

    <release version="1.04.00" date="2019-12-30" description="DSOL Event package added to DJUTILS">
      <action dev="averbraeck" type="add">
        The event package for pub/sub, originally the dsol-event package, has been added to DJUTILS and 
        will be removed from the next version of DSOL.
      </action>
      <action dev="averbraeck" type="fix">
        Many open issues in the DSOL event package has been fixed in the port to DJUTILS. Examples are adding
        equals and hashCode methods for the TimedEvent, better writeObject and readObject methods for the
        EventListenerMap, repair of the failure to sometimes remove an EventListener from the EventProducer, etc. 
      </action>
      <action dev="averbraeck" type="add">
        Almost full unit test coverage has been added to the djunits event package. 
      </action>
      <action dev="averbraeck" type="update">
        The event producing collections in the event.util package now only fire events when additions or 
        removals actually took place, not just when the add / remove / put methods are called.  
      </action>
      <action dev="averbraeck" type="add">
        The EventProducingCollection, EventProducingList, EventProducingMap and EventProducingSet in the 
        event.util package also fire events when content in the collections has changed. In that case, 
        a CHANGE_EVENT is fired.
      </action>
      <action dev="averbraeck" type="add">
        The events of the event producing collections in the event.util package now have events that carry a
        payload. The payload is the new number of entries in the collection for the ADD_EVENT and REMOVE_EVENT.
        The event's content is equal to null for the CHANGE_EVENT.
      </action>
      <action dev="averbraeck" type="update">
        Since the boolean for strong versus weak references in the EventProducer was always unclear (does
        true mean strong or weak?), it has been replaced by an enum.   
      </action>
      <action dev="averbraeck" type="update">
        Several of the underlying data structures of the djutils package have been changed from a HashMap
        to a LinkedHashMap and from a HashSet to a LinkedHashSet to guarantee reproducibility of results.
        As an exception the ImmutableHashSet and ImmutableHashMap are still backed by unlinked variants,
        as they explicitly are not reproducible.
      </action>      
      <action dev="averbraeck" type="update">
        DJUNITS updated to 4.01.03.
      </action>
      <action dev="averbraeck" type="add">
        Extensive unit test coverage has been added for the ClassUtil class. Several errors have been repaired,
        and the signature of a number of methods has changed slightly (getAllMethods returns a List rather than
        an array, for example). 
      </action>
    </release>
    
    <release version="1.03.02" date="2019-10-31" description="SpotBugs instead of FindBugs in Maven">
      <action dev="averbraeck" type="fix">
        Ensured that "package-list" exists in apidocs for backward compatibility of javadoc linking.
      </action>
      <action dev="averbraeck" type="fix">
        Replaced FindBugs (which already had a problem supporting Java 8) with SpotBugs 
        (supporting later Java versions as well).
      </action>
      <action dev="averbraeck" type="update">
        DJUNITS updated to 4.01.01.
      </action>
      <action dev="averbraeck" type="update">
        Included jakarta.annotation-api to be compatible with Java 11+.
      </action>
      <action dev="averbraeck" type="fix">
        tt-tag in javadoc replaced by code-tag to be compatible with HTML-5 and Java-11+.
      </action>
      <action dev="averbraeck" type="fix">
        javadoc source version 8 added to pom-file to be compatible with Java-11+.
      </action>
    </release>
    
    <release version="1.03.01" date="2019-10-25" description="Updated DJUTILS to version 4">
      <action dev="averbraeck" type="update">
        DJUNITS updated to 4.01.00.
      </action>
    </release>
    
    <release version="1.03.00" date="2019-10-19" description="@Generated annotations in code in djutils-cli">
      <action dev="averbraeck" type="update">
        CliUnitConverters in djutils-ext have been regenerated. A @Generated tag has been added to each generated method. 
      </action>
    </release>
    
    <release version="1.03.00" date="2019-10-19" description="Little Endian (de)serialization; use of djunits v4">
      <action dev="averbraeck" type="remove">
        Little-Endian types have been removed as FieldTypes in djutils-serialization. Instead, messages that
        need to be decoded can indicate whether they want to (de)code as Little-Endian or Big-Endian.
        By default, following Java standards, djutils-serialization encodes in Big Endian (network byte order).
      </action>
      <action dev="averbraeck" type="update">
        DJUNITS has been updated to version 4.00.04, bringing major changes to the way vectors and matrices
        are stored and processed.
      </action>
      <action dev="averbraeck" type="remove">
        As a result of moving to DJUNITS-4, the Money units with their special encoding have been removed
        temporarily. This also holds for the MoneyPerUnit types.
      </action>
      <action dev="averbraeck" type="add">
        As a result of moving to DJUNITS-4, several new types have been added to the possible units to use: 
        AbsorbedDose, AmountOfSubstance, CatalyticActivity, ElectricalCapacitance, ElectricalConductance, 
        ElectricalInductance, EquivalentDose, Illuminance, LuminousFlux, LuminousIntensity, 
        MagneticFluxDensity, MagneticFlux, and RadioActivity.
      </action>
      <action dev="averbraeck" type="update">
        The package structure for djutils-serialization has been updated. Complex (de)serializers
        have been coded in their own classes rather than in an inline class.
      </action>
    </release>
    
    <release version="1.02.03" date="2019-09-14" description="CliUtil.execute with CommandLine object; unit tests">
      <action dev="averbraeck" type="add">
        CliUtil in djutils-ext now has a method call with a CommandLine object. This enables e.g., the
        registration of custom parameter converters. An example and test is provided in 
        TestCLIRegisterConverters.java in the test package.
      </action>
      <action dev="averbraeck" type="add">
        Added unit tests for djunits converters for the CLI package. Dimensionless can also parse just a number.
      </action>
      <action dev="averbraeck" type="fix">
        Unit tests with System.exit() were failing in Maven surefire. Surefire documents that System.exit()
        calls cannot be tested. Therefore a Security Manager has been implemented in the test class ExitHelper
        for these tests that catches the System.Exit and turns it into an ExitException. 
      </action>
      <action dev="averbraeck" type="fix">
        Repaired the code for the ClassFileDescriptor for paths with spaces.
      </action>
      <action dev="averbraeck" type="add">
        Added a unit test to see if folders with spaces can be found for the ClassFileDescriptor.
      </action>
      <action dev="averbraeck" type="fix">
        Repaired a bug for folders with spaces for the ClassFileDescriptor.
      </action>
      <action dev="averbraeck" type="add">
        Added unit tests for ClassUtil.
      </action>
      <action dev="averbraeck" type="fix">
        Repaired a number of bugs and changed some code in ClassUtil. It does not make sense to resolve
        constructors of superclasses, as only constructors of a class to be instantiated can be called.
        Therefore all code that deals with constructors in superclasses has been removed. 
      </action>
      <action dev="averbraeck" type="update">
        The methods in ClassUtil that deal with visibility from a callerClass now throw an 
        IllegalAccessException when the method/field/constructor is not visible from the callerClass
        and a NoSuchMethodException or NoSuchFieldException when the method/constructor/field
        cannot be found.  
      </action>
    </release>

    <release version="1.02.02" date="2019-08-16" description="Resolving annotations">
      <action dev="averbraeck" type="add">
        ClassUtil has resolveAnnotation methods.
      </action>
      <action dev="averbraeck" type="add">
        CliUtil also resolved @Command and @Option annotations in a superclass.
      </action>
    </release>

    <release version="1.02.01" date="2019-08-13" description="CLI helper methods, ClassFileDescriptor">
      <action dev="averbraeck" type="add">
        ClassUtil got extra methods to retrieve information about a class file, e.g. the last changed date.
      </action>
      <action dev="averbraeck" type="fix">
        CliIUtil has been renamed to the correct CliUtil.
      </action>
      <action dev="averbraeck" type="add">
        Several helper methods have been added to CliUtil to change some of the @Options and
        @Command settings.
      </action>
    </release>
    
    <release version="1.02.00" date="2019-08-11" description="djutils-ext project added; CLI code">
      <action dev="averbraeck" type="add">
        A project for more utility classes that require more dependencies called djutils-ext has been added.
      </action>
      <action dev="averbraeck" type="add">
        Classes for Command Line Interface parsing have been added. The classes are based on picocli.
      </action>
      <action dev="averbraeck" type="add">
        A utility class with converters for DJUTILS command line arguments has been added. With these
        converters, it is possible to e.g. specify --timeout=30s on the command line and convert the 
        timeout to a DJUNITS Duration scalar. 
      </action>
    </release>

    <release version="1.01.03" date="2019-07-04" description="byte[][] serialization repaired">
      <action dev="averbraeck" type="fix">
        The byte[][] serialization destroyed the underlying data -- this has been repaired.
      </action>
      <action dev="averbraeck" type="update">
        The serializers have all been made strongly typed, avoiding casting. Or actually, the casting has been 
        shifted to the encode method on a higher level.
      </action>
    </release>

    <release version="1.01.02" date="2019-07-02" description="ImmutableLinkedHashMap.values() repaired">
      <action dev="averbraeck" type="fix">
        The ImmutableLinkedHashMap.values() was overriding a non-reproducible values() method from the 
        ImmutableAbstractMap. The ImmutableLinkedHashMap now has its own values() method.
      </action>
    </release>
  
    <release version="1.01.01" date="2019-07-01" description="ImmutableLinkedHashMap repaired; serialization of UTF-8, UTF-16">
      <action dev="averbraeck" type="fix">
        The ImmutableLinkedHashMap returned a non-linked HashSet as EntrySet and as KeySet. This has
        been repaired.
      </action>
      <action dev="averbraeck" type="fix">
        The UTF-8 Strings in djutils-serialization have been improved. The UTF-8 String can now handle 
        1-byte, 2-byte, 3-byte and 4-byte characters. The length of the UTF-8 serialized bytes indicates
        the number of bytes. The length does not say anything about the number of characters.
      </action>
      <action dev="averbraeck" type="fix">
        The UTF-16 Strings in djutils-serialization have been improved. The UTF-16 String can now handle
        2-byte and 4-byte characters. The length of the UTF-16 String indicates the number of 2-byte
        shorts in the array. The length does not say anything about the number of characters.
      </action>
      <action dev="pknoppers" type="fix">
        The byte array in djutils-serialization has been repaired. The underlying byte array was nulled 
        during serialization.
      </action>
      <action dev="pknoppers" type="add">
        ObjectArraySerializer and ObjectMatrixSerializer added. 
      </action>
      <action dev="pknoppers" type="add">
        SerialDataDumper added to provide insight into structure of the serialized data.
      </action>
    </release>

    <release version="1.01.00" date="2019-06-21" description="djutils-serialization project added">
      <action dev="pknoppers" type="add">
        The djunits-serialization project has been added to serialize and deserialize different classes
        including djunits scalars, vectors and matrices in a strongly typed manner.
      </action>
    </release>

    <release version="1.00.06" date="2019-05-10" description="EntrySets added; caching of keySet, values in Map">
      <action dev="averbraeck" type="add">
        EntrySets have been added to the ImmutableMap classes.
      </action>
      <action dev="averbraeck" type="update">
        The keySet(), values() and entrySet() methods cache the results as these are often called.
      </action>
    </release>

    <release version="1.00.05" date="2019-02-26" description="ImmutableCollections class added">
      <action dev="averbraeck" type="add">
        The ImmutableCollections class has been added, which takes care of those functions of the
        Collections class that do not update the (immutable) collections that the methods receive
        as arguments.
      </action>
    </release>

    <release version="1.00.04" date="2019-01-29" description="Removed logger Cat class">
      <action dev="averbraeck" type="remove">
        Cat class in the logger package belongs in dsol, not in djutils, so removed it.
      </action>
    </release>

    <release version="1.00.03" date="2018-12-18" description="DecoderDumper package">
      <action dev="pknoppers" type="add">
        The 'decoderdumper' package has been added to the djutils project, extending
        and replacing HexDump. 
      </action>
    </release>

    <release version="1.00.02" date="2019-01-17" description="ConditionalLogger, HexDump">
      <action dev="averbraeck" type="add">
        The CategoryLogger has been extended with a 'when(condition)' static method. 
        A call like CategoryLogger.when(ok).always().info("Ok"); is now possible.
      </action>
      <action dev="pknoppers" type="add">
        The HexDump class has been added to djutils to create hexadecimal dumps of data.
      </action>
      <action dev="averbraeck" type="update">
        Copyright message changed to 2019.
      </action>
    </release>

    <release version="1.00.01" date="2018-12-15" description="Means package">
      <action dev="pknoppers" type="add">
        The 'means' package has been added to the djutils project. 
      </action>
    </release>

    <release version="1.00.00" date="2018-11-17" description="Initial release">
      <action dev="averbraeck" type="add">
        Several classes from other projects that are heavily shared between the projects, but not 
        specific for one of the projects have been transferred to the djutils project. 
      </action>
    </release>

  </body>
</document>